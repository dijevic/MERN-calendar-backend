(this["webpackJsonpcalendar-app"]=this["webpackJsonpcalendar-app"]||[]).push([[0],{110:function(e,t,n){},243:function(e,t,n){},244:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(11),c=n.n(r),o=n(8),s=n(87),i=n(9),l=n(6),u=n(13),j=n.n(u),d=n(23),b=n(14),O=n.n(b),m="https://calndar-mern2021.herokuapp.com",p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2?arguments[2]:void 0,a="".concat(m).concat(n);return"GET"===t?fetch(a):fetch(a,{method:t,body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})},f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2?arguments[2]:void 0,a="".concat(m).concat(n),r=localStorage.getItem("token")||"";return"GET"===t?fetch(a,{headers:{"x-token":r}}):fetch(a,{method:t,body:JSON.stringify(e),headers:{"Content-Type":"application/json","x-token":r}})},v="[ui] modal open",h="[ui] modal close",g="[ui] event load events",x="[Calendar] event add new",y="[Calendar] set active",S="[Calendar] unset active",N="[Calendar] clean calendar",k="[Calendar] event update",w="[Calendar] event delete",E="[Calendar] event onSlot selected",C="[Calendar] event onSlot unselected",T="[Calendar] auth Unset checking",D="[Calendar] auth  login",I="[Calendar] auth log out",P="[ui][auth] error",A=n(19),_=n.n(A),G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{end:_()(e.end).toDate(),start:_()(e.start).toDate()})}))},L=function(e){return{type:g,payload:e}},R=function(e){return{type:x,payload:e}},F=function(){return{type:S}},B=function(e){return{type:k,payload:e}},V=function(){return{type:w}},H=function(){return{type:C}},J=function(e){return{type:D,payload:Object(l.a)({},e)}},M=function(){return{type:T}},U=function(){return function(e){localStorage.clear(),localStorage.removeItem("token"),e({type:N}),e(q())}},q=function(){return{type:I}},X=n(15),z=n(29),K=n.n(z),Q=n(27),W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(a.useState)(e),n=Object(X.a)(t,2),r=n[0],c=n[1],o=function(){c(e)},s=function(e){var t=e.target;c(Object(l.a)(Object(l.a)({},r),{},Object(Q.a)({},t.name,t.value)))};return[r,s,o]},Y=(n(110),n(83)),Z=n.n(Y),$=n(2),ee=function(){return Object($.jsxs)("div",{className:"spinner",children:[Object($.jsx)(Z.a,{type:"Bars",color:"#00BFFF",height:100,width:100}),Object($.jsx)("span",{className:"loader__span",children:" Loading... "})]})},te=function(){var e=Object(o.b)(),t=Object(a.useState)(!1),n=Object(X.a)(t,2),r=n[0],c=n[1],s=Object(o.c)((function(e){return e.auth})).checking;Object(a.useEffect)((function(){localStorage.getItem("tokenDateStart")&&(c(!0),localStorage.clear(),setTimeout((function(){c(!1)}),3e3))}),[]);var i=W({LoginEmail:"",loginPassword:""}),l=Object(X.a)(i,2),u=l[0],b=l[1],m=W({registerEmail:"",registerPassword:"",registerPassword2:"",registerName:""}),f=Object(X.a)(m,2),v=f[0],h=f[1],g=u.LoginEmail,x=u.loginPassword,y=v.registerEmail,S=v.registerPassword,N=v.registerPassword2,k=v.registerName;return s?Object($.jsx)(ee,{}):Object($.jsxs)("div",{className:"container login-container",children:[r&&Object($.jsx)("p",{className:"tokenEndedText",children:"Sesion vencida por falta de actividad"}),Object($.jsxs)("div",{className:"row",children:[Object($.jsxs)("div",{className:"col-md-6 login-form-1",children:[Object($.jsx)("h3",{children:"Ingreso"}),Object($.jsxs)("form",{onSubmit:function(t){var n,a;t.preventDefault(),e((n=g,a=x,function(){var e=Object(d.a)(j.a.mark((function e(t){var r,c,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p({email:n,password:a},"POST","auth");case 3:return r=e.sent,e.next=6,r.json();case 6:(c=e.sent).ok?(localStorage.setItem("token",c.token),localStorage.setItem("tokenDateStart",(new Date).getTime()),o={id:c.userId,name:c.name},t(J(o))):O.a.fire("Error en el login :(","error en el password o email","error"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()))},children:[Object($.jsx)("div",{className:"form-group",children:Object($.jsx)("input",{type:"text",className:"form-control",placeholder:"Correo",name:"LoginEmail",value:g,onChange:b})}),Object($.jsx)("div",{className:"form-group",children:Object($.jsx)("input",{type:"password",className:"form-control",placeholder:"Contrase\xf1a",name:"loginPassword",value:x,onChange:b})}),Object($.jsx)("div",{className:"form-group",children:Object($.jsx)("input",{type:"submit",className:"btnSubmit",value:"Login"})})]})]}),Object($.jsxs)("div",{className:"col-md-6 login-form-2",children:[Object($.jsx)("h3",{children:"Registro"}),Object($.jsxs)("form",{onSubmit:function(t){return t.preventDefault(),K.a.isEmail(y)?K.a.isEmpty(S)||K.a.isEmpty(N||K.a.isEmpty(k))?O.a.fire("error","campos no pueden estar vacios","error"):K.a.equals(S.toString(),N.toString())?void e((n=y,a=S,r=k,function(){var e=Object(d.a)(j.a.mark((function e(t){var c,o,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p({email:n,password:a,name:r},"POST","auth/register");case 3:return c=e.sent,e.next=6,c.json();case 6:(o=e.sent).ok?(localStorage.setItem("token",o.token),localStorage.setItem("tokenDateStart",(new Date).getTime()),s={id:o.userId,name:o.name},t(J(s))):O.a.fire("Error en el registro :(",o.msg,"error"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}())):O.a.fire("error","las contrase\xf1as deben de ser iguales","error"):O.a.fire("error","email invalido","error");var n,a,r},children:[Object($.jsx)("div",{className:"form-group",children:Object($.jsx)("input",{type:"text",className:"form-control",placeholder:"Nombre",name:"registerName",value:k,onChange:h})}),Object($.jsx)("div",{className:"form-group",children:Object($.jsx)("input",{type:"email",className:"form-control",placeholder:"Correo",name:"registerEmail",value:y,onChange:h})}),Object($.jsx)("div",{className:"form-group",children:Object($.jsx)("input",{type:"password",className:"form-control",placeholder:"Contrase\xf1a",name:"registerPassword",value:S,onChange:h})}),Object($.jsx)("div",{className:"form-group",children:Object($.jsx)("input",{type:"password",className:"form-control",placeholder:"Repita la contrase\xf1a",name:"registerPassword2",value:N,onChange:h})}),Object($.jsx)("div",{className:"form-group",children:Object($.jsx)("input",{type:"submit",className:"btnSubmit",value:"Crear cuenta"})})]})]})]})]})},ne=n(57),ae=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.auth.user})).name;return Object($.jsx)("div",{children:Object($.jsxs)("nav",{className:"navbar navbar-dark bg-dark mb-4",children:[Object($.jsx)("span",{className:"navbar-brand",children:t}),Object($.jsxs)("button",{onClick:function(){e(U())},className:"btn btn-outline-danger",children:[Object($.jsx)("i",{className:"fa fa-sign-out-alt",children:" "}),Object($.jsx)("span",{children:"Salir"})]})]})})},re={allDay:"Todo el d\xeda",previous:"<",next:">",today:"Hoy",month:"Mes",week:"Semana",day:"D\xeda",agenda:"Agenda",date:"Fecha",time:"Hora",event:"Evento",noEventsInRange:"No hay eventos en este rango",showMore:function(e){return"+ Ver m\xe1s (".concat(e,")")}},ce=function(e){var t=e.event,n=t.usuario,a=t.title;return Object($.jsxs)("div",{children:[Object($.jsx)("strong",{children:a})," ",Object($.jsx)("br",{}),Object($.jsx)("span",{children:n.name})]})},oe=(n(210),n(211),n(53)),se=n.n(oe),ie=function(){return{type:v}},le=function(){return{type:h}},ue=n(54),je=n.n(ue),de=_()().minutes(0).seconds(0).add(1,"hours").toDate(),be=_()().minutes(0).seconds(0).add(2,"hours").toDate(),Oe=_()().toDate(),me={title:"",notes:"",start:de,end:be},pe=function(){var e=Object(o.c)((function(e){return e.calendar})),t=e.activeEvent,n=e.onSlotSelected,r=Object(o.b)(),c=n.start,s=n.end,i=Object(a.useState)(de),u=Object(X.a)(i,2),b=u[0],m=u[1],p=Object(a.useState)(be),v=Object(X.a)(p,2),h=v[0],g=v[1],x=Object(a.useState)(!0),y=Object(X.a)(x,2),S=y[0],N=y[1],k=Object(a.useState)(!0),w=Object(X.a)(k,2),E=w[0],C=w[1],T=Object(a.useState)(me),D=Object(X.a)(T,2),I=D[0],P=D[1];Object(a.useEffect)((function(){t?(P(t),m(t.start),g(t.end)):(P(me),m(de),g(be)),c?(m(c),g(s),P((function(e){return Object(l.a)(Object(l.a)({},e),{},{start:c,end:s})}))):t||n||(P(me),m(de),g(be))}),[t,c,s,n]);var A=I.title,G=I.notes,L=I.start,V=I.end,J=function(e){var t=e.target;P(Object(l.a)(Object(l.a)({},I),{},Object(Q.a)({},t.name,t.value)))};return Object($.jsxs)("div",{children:[Object($.jsx)("h1",{children:t?"Editar evento":"Nuevo evento"}),Object($.jsx)("hr",{}),Object($.jsxs)("form",{onSubmit:function(e){e.preventDefault();var n,a=_()(L),c=_()(V);return a.isSameOrAfter(c)?O.a.fire({icon:"error",title:"Oops...",text:"the date of starting and finishing must be diferent"}):A.length<=2?N(!1):a.isBefore(Oe)?C(!1):(N(!0),C(!0),P(me),r(le()),r(H()),r(F()),void r(t?(n=I,function(){var e=Object(d.a)(j.a.mark((function e(t){var a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f(n,"PUT","events/".concat(n.uid));case 3:return a=e.sent,e.next=6,a.json();case 6:(r=e.sent).ok?t(B(n)):O.a.fire("error",r.msg,"error"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()):function(e){return function(){var t=Object(d.a)(j.a.mark((function t(n,a){var r,c,o;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a().auth.user,t.prev=1,t.next=4,f(e,"POST","events");case 4:return c=t.sent,t.next=7,c.json();case 7:(o=t.sent).ok?(e.usuario=r,e.uid=o.newEvent.uid,n(R(e)),console.log(e)):O.a.fire("error","error creando el evento","error"),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e,n){return t.apply(this,arguments)}}()}(I)))},className:"container ",children:[Object($.jsxs)("div",{className:"form-group",children:[Object($.jsx)("label",{children:"Fecha y hora inicio"}),Object($.jsx)(je.a,{onChange:function(e){m(e),P(Object(l.a)(Object(l.a)({},I),{},{start:e}))},value:b,className:"form-control ".concat(!E&&"is-invalid"," ")})]}),Object($.jsxs)("div",{className:"form-group",children:[Object($.jsx)("label",{children:"Fecha y hora fin"}),Object($.jsx)(je.a,{onChange:function(e){g(e),P(Object(l.a)(Object(l.a)({},I),{},{end:e}))},value:h,minDate:b,className:"form-control"})]}),Object($.jsx)("hr",{}),Object($.jsxs)("div",{className:"form-group",children:[Object($.jsx)("label",{children:"Titulo y notas"}),Object($.jsx)("input",{type:"text",className:"form-control ".concat(!S&&"is-invalid"),placeholder:"T\xedtulo del evento",name:"title",autoComplete:"off",value:A,onChange:J}),Object($.jsx)("small",{id:"emailHelp",className:"form-text text-muted",children:"Una descripci\xf3n corta"})]}),Object($.jsxs)("div",{className:"form-group",children:[Object($.jsx)("textarea",{type:"text",className:"form-control",placeholder:"Notas",rows:"5",name:"notes",value:G,onChange:J}),Object($.jsx)("small",{id:"emailHelp",className:"form-text text-muted",children:"Informaci\xf3n adicional"})]}),Object($.jsxs)("button",{type:"submit",className:"btn btn-outline-primary btn-block",children:[Object($.jsx)("i",{className:"far fa-save"}),Object($.jsx)("span",{children:" Guardar"})]})]})]})},fe={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}};se.a.setAppElement("#root");var ve=function(){var e=Object(o.c)((function(e){return e.ui})).modalOpen,t=Object(o.b)();return Object($.jsx)("div",{children:Object($.jsx)(se.a,{isOpen:e,onRequestClose:function(){t(le()),t(F()),t(H())},style:fe,className:"modal",closeTimeoutMS:200,overlayClassName:"modal-fondo",children:Object($.jsx)(pe,{})})})},he=function(){var e=Object(o.b)();return Object($.jsx)("button",{className:"btn btn-primary fab",onClick:function(){e(ie())},children:Object($.jsx)("i",{className:"fa fa-plus"})})},ge=function(){var e=Object(o.b)();return Object($.jsxs)("button",{onClick:function(){e(function(){var e=Object(d.a)(j.a.mark((function e(t,n){var a,r,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n().calendar.activeEvent.uid,e.prev=1,e.next=4,f({},"DELETE","events/".concat(a));case 4:return r=e.sent,e.next=7,r.json();case 7:(c=e.sent).ok?t(V()):O.a.fire("error",c.msg,"error"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,n){return e.apply(this,arguments)}}())},className:"btn btn-danger fab-danger",children:[Object($.jsx)("i",{className:"fa fa-trash mr-2"}),"Borrar evento"]})};_.a.locale("es");var xe=Object(ne.b)(_.a),ye=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.auth.user})).id;Object(a.useEffect)((function(){localStorage.getItem("token")&&e(function(){var e=Object(d.a)(j.a.mark((function e(t){var n,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f(!1,"GET","events");case 3:return n=e.sent,e.next=6,n.json();case 6:(a=e.sent).ok?(r=G(a.eventos),t(L(r))):O.a.fire("error","error creando el evento","error"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}())}),[e]);var n=Object(o.c)((function(e){return e.calendar})).events,r=Object(o.c)((function(e){return e.calendar})).activeEvent,c=Object(a.useState)(localStorage.getItem("lastView")||"month"),s=Object(X.a)(c,2),i=s[0],l=s[1];return Object($.jsxs)("div",{className:"calendar-container",children:[Object($.jsx)(ae,{}),Object($.jsx)(ne.a,{localizer:xe,events:n,startAccessor:"start",endAccessor:"end",messages:re,eventPropGetter:function(e){return{style:{backgroundColor:t===e.usuario._id||t===e.usuario.id?"#367cf7":"#00112c",borderRadius:"0px",color:"#fff",opacity:"0.8"}}},onView:function(e){l(e),localStorage.setItem("lastView",e)},onDoubleClickEvent:function(t){e(ie())},onSelectEvent:function(t){e({type:y,payload:t})},view:i,onSelectSlot:function(t){e(F()),e(ie()),e(function(e){var t=e.start,n=e.end;return{type:E,payload:{start:t,end:n}}}(t))},selectable:!0,components:{event:ce}}),Object($.jsx)(ve,{}),Object($.jsx)(he,{}),r&&Object($.jsx)(ge,{})]})},Se=n(40),Ne=["component","isAuth"],ke=function(e){var t=e.component,n=e.isAuth,a=Object(Se.a)(e,Ne);return Object($.jsx)(i.b,Object(l.a)(Object(l.a)({},a),{},{component:function(e){return n?Object($.jsx)(t,Object(l.a)({},e)):Object($.jsx)(i.a,{to:"/login"})}}))},we=["component","isAuth"],Ee=function(e){var t=e.component,n=e.isAuth,a=Object(Se.a)(e,we);return Object($.jsx)(i.b,Object(l.a)(Object(l.a)({},a),{},{component:function(e){return n?Object($.jsx)(i.a,{to:"/"}):Object($.jsx)(t,Object(l.a)({},e))}}))},Ce=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.auth})),n=t.checking,r=t.user;return Object(a.useEffect)((function(){localStorage.getItem("token")?e(function(){var e=Object(d.a)(j.a.mark((function e(t){var n,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f(!1,"GET","auth/renew");case 3:return n=e.sent,e.next=6,n.json();case 6:(a=e.sent).ok?(localStorage.setItem("token",a.token),localStorage.setItem("tokenDateStart",(new Date).getTime()),r={id:a.userId,name:a.name},t(J(r))):(console.log(a),t(M())),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()):e(M())}),[e]),n?Object($.jsx)(ee,{}):Object($.jsx)(s.a,{children:Object($.jsx)("div",{children:Object($.jsxs)(i.d,{children:[Object($.jsx)(Ee,{path:"/login",exact:!0,component:te,isAuth:r}),Object($.jsx)(ke,{path:"/",exact:!0,component:ye,isAuth:r}),Object($.jsx)(i.a,{to:"/login"})]})})})},Te=(n(243),n(28)),De=n(88),Ie={checking:!0,user:!1},Pe=n(58),Ae={events:[],activeEvent:null,onSlotSelected:!1},_e={modalOpen:!1,uiError:null},Ge=Object(Te.b)({ui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_e,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:return Object(l.a)(Object(l.a)({},e),{},{modalOpen:!0});case h:return Object(l.a)(Object(l.a)({},e),{},{modalOpen:!1});case P:return Object(l.a)(Object(l.a)({},e),{},{uiError:t.payload});default:return e}},calendar:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return Object(l.a)(Object(l.a)({},e),{},{activeEvent:t.payload});case g:return Object(l.a)(Object(l.a)({},e),{},{events:Object(Pe.a)(t.payload)});case x:return Object(l.a)(Object(l.a)({},e),{},{events:[].concat(Object(Pe.a)(e.events),[t.payload])});case S:return Object(l.a)(Object(l.a)({},e),{},{activeEvent:null});case k:return Object(l.a)(Object(l.a)({},e),{},{events:e.events.map((function(e){return e.uid===t.payload.uid?t.payload:e}))});case w:return Object(l.a)(Object(l.a)({},e),{},{events:e.events.filter((function(t){return t.uid!==e.activeEvent.uid})),activeEvent:null});case E:return Object(l.a)(Object(l.a)({},e),{},{onSlotSelected:t.payload});case C:return Object(l.a)(Object(l.a)({},e),{},{onSlotSelected:!1});case N:return Ae;default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:return Object(l.a)(Object(l.a)({},e),{},{checking:!1,user:t.payload});case T:return Object(l.a)(Object(l.a)({},e),{},{checking:!1});case I:return{checking:!1,user:!1};default:return e}}}),Le=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Te.c,Re=Object(Te.d)(Ge,Le(Object(Te.a)(De.a))),Fe=function(){return Object($.jsx)("div",{children:Object($.jsx)(o.a,{store:Re,children:Object($.jsx)(Ce,{})})})};c.a.render(Object($.jsx)(Fe,{}),document.getElementById("root"))}},[[244,1,2]]]);
//# sourceMappingURL=main.3c48592b.chunk.js.map